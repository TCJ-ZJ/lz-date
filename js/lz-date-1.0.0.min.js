(function(e){var b=/^(\d{4})\/(\d{1,2})\/(\d{1,2})$/;var a=/^(\d{4})-(\d{1,2})-(\d{1,2})$/;var d=0;e.extend({isArray:function(h){return Object.prototype.toString.call(h)==="[object Array]";
},isObject:function(h){return Object.prototype.toString.call(h)==="[object Object]";},isDate:function(h){if(h===undefined||!h){return false;}var i=h.match(b)||h.match(a);
var j=new Date(i[1],i[2]-1,i[3]);return !!(j.getFullYear()==i[1]&&j.getMonth()==i[2]-1&&j.getDate()==i[3]);},formateDate:function(h){var i=h.match(b)||h.match(a);
return i;},getDays:function(i,j){var h=(i%4==0)&&(i%100!=0||i%400==0);return(j==4||j==6||j==9||j==11)?30:j!=2?31:h?29:28;},getWeek:function(h,i){return new Date(h+"/"+i+"/1").getDay();
}});var c=function(h){this.$ele=e(h);this.param=this.$ele.data("date-param");this.status=this.$ele.data("date-status");this.box=this.$ele.data("date-box");
};c.prototype.setEvent=function(){var h=this,i=this.param;if(e.isArray(i.event)){e.each(i.event,function(j,k){h[k]&&h[k]();});}else{h[i.event]&&h[i.event]();
}};c.prototype.display=function(){var k=this.$ele,i=k.get(0),h=this.status,j=this.box;k.on("click",function(l){l.stopPropagation();i.dateexcute.setPosition();
i.dateexcute.setDate();i.dateexcute.setDays();e(".lzdate-box").css("display","none");j.css("display","block");});j.on("click",function(l){l.stopPropagation();
});e(document).on("click",function(m){m.preventDefault();var l=m.target||m.srcElement;e(".lzdate-box").css("display","none");});};c.prototype.change=function(){var k=this.$ele,i=k.get(0),j=this.box,h=this.status;
j.find(".lzdate-header").on("click",function(m){m.preventDefault();var l=m.target||m.srcElement;if(l.nodeName.toLowerCase()==="p"){if(e(l).hasClass("lzdate-prev-year")){h.year-=1;
}else{if(e(l).hasClass("lzdate-prev-month")){h.month-=1;}else{if(e(l).hasClass("lzdate-next-year")){h.year+=1;}else{if(e(l).hasClass("lzdate-next-month")){h.month+=1;
}}}}if(h.month==0){h.year-=1;h.month=12;}else{if(h.month>12){h.year+=1;h.month=1;}}i.dateexcute.setDate();i.dateexcute.setDays();}});};c.prototype.value=function(){var k=this.$ele,i=k.get(0),j=this.box,l=this.param,h=this.status;
j.find(".lzdate-days").on("click",function(o){o.preventDefault();var n=o.target||o.srcElement;if(n.nodeName.toLowerCase()==="li"){if(e(n).hasClass("lzdate-disable")){return false;
}else{var m=e(n).html()=="今天"?h.cDay:e(n).html();k.val(h.year+"-"+h.month+"-"+m);j.css("display","none");if(l.fn){l.fn();}}}});};var g=function(h){this.$ele=e(h);
this.param=this.$ele.data("date-param");this.status=this.$ele.data("date-status");};g.prototype.setPosition=function(){var i=this.$ele,h=i.data("date-box");
h.css({top:i.offset().top+i.height()+6,left:i.offset().left});};g.prototype.setDate=function(){var j=this.$ele,h=this.status,i=j.data("date-box");i.find(".lzdate-main").find("span").eq(0).html(h.year);
i.find(".lzdate-main").find("span").eq(1).html(h.month);};g.prototype.setDays=function(){var p=this.$ele,j=this.param,m=this.status,o=p.data("date-box"),k=null;
var s=e.getDays(m.year,m.month),l=e.getWeek(m.year,m.month);var q=document.createDocumentFragment();for(var n=1;n<=s;n++){if(m.year===m.cYear&&m.month===m.cMonth&&m.cDay===n&&j.today){k=e("<li>今天</li>").addClass("lzdate-today");
}else{k=e("<li>"+n+"</li>");}var h=m.year>m.smYear||(m.year==m.smYear&&m.month>m.smMonth)||(m.year==m.smYear&&m.month==m.smMonth&&n>=m.smDay);var r=m.year<m.lgYear||(m.year==m.lgYear&&m.month<m.lgMonth)||(m.year==m.lgYear&&m.month==m.lgMonth&&n<=m.lgDay);
if(!r||!h){k.addClass("lzdate-disable");}e(q).append(k);}o.find(".lzdate-days").html(q);o.find(".lzdate-days li").eq(0).css("marginLeft",l*32);};var f=function(k,i,h,l,j){this.$ele=e(k);
this.$ele.data("date-param",this.initParam(i,h,l,j));this.$ele.data("date-status",{boxid:null,dateBox:null,now:null,cYear:null,cMonth:null,cDay:null,smYear:null,smMonth:null,smDay:null,lgYear:null,lgMonth:null,lgDay:null,year:null,month:null,selectYear:null,selectMonth:null,selectDay:null,selectDate:null,mouseH:false});
};f.prototype.layout=function(){var m=this.$ele,n=m.data("date-param"),h=m.data("date-status");m.attr("readonly","readonly");var k=new Date();h.now=k;h.cYear=k.getFullYear();
h.cMonth=k.getMonth()+1;h.cDay=k.getDate();h.year=k.getFullYear();h.month=k.getMonth()+1;var j=e.formateDate(n.smDate);var l=e.formateDate(n.lgDate);h.smYear=j[1]-0;
h.smMonth=j[2]-0;h.smDay=j[3]-0;h.lgYear=l[1]-0;h.lgMonth=l[2]-0;h.lgDay=l[3]-0;h.boxid="lzbox-"+(d++);var i="";i+="<div id='"+h.boxid+"' class='lzdate-box'>";
i+="<div class='lzdate-header'>";i+="<p class='lzdate-prev-year'></p>";i+="<p class='lzdate-prev-month'></p>";i+="<p class='lzdate-main'>";i+="<span></span>年";
i+="<span></span>月";i+="</p>";i+="<p class='lzdate-next-month'></p>";i+="<p class='lzdate-next-year'></p>";i+="</div>";i+="<ul class='lzdate-weeks'>";i+="<li>日</li><li>一</li><li>二</li><li>三</li><li>四</li><li>五</li><li>六</li>";
i+="</ul>";i+="<ul class='lzdate-days'></ul>";i+="</div>";e("body").append(i);m.data("date-box",e("#"+h.boxid));};f.prototype.initEvent=function(){var j=this.$ele,h=j.data("date-status"),i=j.data("date-box");
event=new c(j);event.setEvent();};f.prototype.initParam=function(i,h,l,k){var j={smDate:"1970-01-01",lgDate:"2020-12-31",today:true,event:["display","change","value"],fn:null};
if(e.isObject(i)){j=e.extend({},j,i);j.fn=h;}else{j.smDate=i;j.lgDate=h;j.today=l;j.fn=k;}typeof i==="boolean"&&(j.today=i);typeof i==="function"&&(j.fn=i);
if(this.$ele.data("date-param")){j=e.extend({},j,this.$ele.data("date-param"));}!e.isDate(j.smDate)&&(j.smDate="1970-01-01");!e.isDate(j.lgDate)&&(j.lgDate="2020-12-31");
j.today=(j.today===false)?false:true;j.fn=typeof j.fn=="function"?j.fn:null;return j;};e.fn.dateTool=function(){var i=e(this);var h={self:i,param:i.data("date-param"),status:i.data("date-status"),box:i.data("date-box"),setSmDate:function(k){if(e.isDate(k)){var j=e.formateDate(k);
this.status.smYear=j[1]-0;this.status.smMonth=j[2]-0;this.status.smDay=j[3]-0;}return this;},setLgDate:function(k){if(e.isDate(k)){var j=e.formateDate(k);
this.status.lgYear=j[1]-0;this.status.lgMonth=j[2]-0;this.status.lgDay=j[3]-0;}return this;}};return h;};e.fn.lzdate=function(i,h,l,k){var j=e(this);e.each(j,function(n,o){var m=new f(o,i,h,l,k);
o.dateexcute=new g(o);m.layout();m.initEvent();});return j;};})(jQuery);